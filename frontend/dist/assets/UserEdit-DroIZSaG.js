import{j as e}from"./query-B88w_-l3.js";import{r as i}from"./vendor-BKU87Gzz.js";import{u as $,L as D,k as O,W as z,m as U,Q as T,c,N as L,e as I,O as B,b as N,K as u}from"./index-DY2ZM4tI.js";import{c as G,a as M}from"./router-Cr3qqr-L.js";import{F as v}from"./ArrowLeftIcon-DeKPabn9.js";import{F as J}from"./EnvelopeIcon-6kO86Iod.js";import{F as K}from"./PhoneIcon-I1tsrdWX.js";import{F as k}from"./EyeSlashIcon-Diu9gw8K.js";import"./utils-CZH8StwO.js";const re=()=>{const{id:l}=G(),m=M(),{user:Q}=$(),[E,g]=i.useState(!0),[f,p]=i.useState(!1),[y,A]=i.useState(null),[x,F]=i.useState(!1),[h,S]=i.useState(!1),[r,w]=i.useState({name:"",email:"",phone:"",role:"OPERATOR",badgeNumber:"",isActive:!0,password:"",confirmPassword:""}),[a,j]=i.useState({});i.useEffect(()=>{(async()=>{try{g(!0);const t=await fetch(`/api/users/${l}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.ok)throw new Error("Erro ao carregar dados do usuário");const n=await t.json();if(n.success){const o=n.data;w({name:o.name||"",email:o.email||"",phone:o.phone||"",role:o.role||"OPERATOR",badgeNumber:o.badgeNumber||"",isActive:o.isActive!==void 0?o.isActive:!0,password:"",confirmPassword:""})}else throw new Error(n.message||"Erro ao carregar dados do usuário")}catch{A("Erro ao carregar dados do usuário"),u.error("Erro ao carregar dados do usuário")}finally{g(!1)}})()},[l]);const C=()=>{const s={};return r.name.trim()||(s.name="Nome é obrigatório"),r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(s.email="Email inválido"):s.email="Email é obrigatório",r.password&&(r.password.length<6&&(s.password="Senha deve ter pelo menos 6 caracteres"),r.password!==r.confirmPassword&&(s.confirmPassword="Senhas não coincidem")),r.badgeNumber&&r.badgeNumber.length<3&&(s.badgeNumber="Número do crachá deve ter pelo menos 3 caracteres"),j(s),Object.keys(s).length===0},P=async s=>{if(s.preventDefault(),!C()){u.error("Por favor, corrija os erros no formulário");return}try{p(!0);const t={name:r.name.trim(),email:r.email.trim(),phone:r.phone.trim()||null,role:r.role,badgeNumber:r.badgeNumber.trim()||null,isActive:r.isActive};r.password&&(t.password=r.password);const o=await(await fetch(`/api/users/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(t)})).json();if(o.success)u.success("Usuário atualizado com sucesso!"),m(`/users/${l}`);else throw new Error(o.message||"Erro ao atualizar usuário")}catch(t){console.error("Erro ao atualizar usuário:",t),u.error(t.message||"Erro ao atualizar usuário")}finally{p(!1)}},d=s=>{const{name:t,value:n,type:o,checked:R}=s.target;w(b=>({...b,[t]:o==="checkbox"?R:n})),a[t]&&j(b=>({...b,[t]:""}))};return E?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(D,{size:"lg"})}):y?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(O,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:y}),e.jsxs("button",{onClick:()=>m("/users"),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Voltar aos Usuários"]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsx("title",{children:"Editar Usuário - Sistema ZARA"}),e.jsx("meta",{name:"description",content:"Editar informações do usuário"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>m(`/users/${l}`),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(v,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Editar Usuário"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Atualize as informações do usuário"})]})]})}),e.jsx(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:e.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nome Completo *"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:d,className:c("w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",a.name?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),placeholder:"Digite o nome completo"})]}),a.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email *"}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"email",id:"email",name:"email",value:r.email,onChange:d,className:c("w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",a.email?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),placeholder:"Digite o email"})]}),a.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Telefone"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:r.phone,onChange:d,className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Digite o telefone"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Função *"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsxs("select",{id:"role",name:"role",value:r.role,onChange:d,className:"w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"OPERATOR",children:"Operador"}),e.jsx("option",{value:"LEADER",children:"Líder"}),e.jsx("option",{value:"MANAGER",children:"Gerente"}),e.jsx("option",{value:"ADMIN",children:"Administrador"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"badgeNumber",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Número do Crachá"}),e.jsx("input",{type:"text",id:"badgeNumber",name:"badgeNumber",value:r.badgeNumber,onChange:d,className:c("w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",a.badgeNumber?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),placeholder:"Digite o número do crachá"}),a.badgeNumber&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.badgeNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status da Conta"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:r.isActive,onChange:d,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Conta ativa"})]}),r.isActive?e.jsx(I,{className:"h-5 w-5 text-green-500"}):e.jsx(B,{className:"h-5 w-5 text-red-500"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Alterar Senha (opcional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:x?"text":"password",id:"password",name:"password",value:r.password,onChange:d,className:c("w-full pr-10 pl-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",a.password?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),placeholder:"Digite a nova senha"}),e.jsx("button",{type:"button",onClick:()=>F(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x?e.jsx(k,{className:"h-5 w-5"}):e.jsx(N,{className:"h-5 w-5"})})]}),a.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:h?"text":"password",id:"confirmPassword",name:"confirmPassword",value:r.confirmPassword,onChange:d,className:c("w-full pr-10 pl-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",a.confirmPassword?"border-red-300 dark:border-red-600":"border-gray-300 dark:border-gray-600"),placeholder:"Confirme a nova senha"}),e.jsx("button",{type:"button",onClick:()=>S(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:h?e.jsx(k,{className:"h-5 w-5"}):e.jsx(N,{className:"h-5 w-5"})})]}),a.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:a.confirmPassword})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:()=>m(`/users/${l}`),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Salvando..."]}):"Salvar Alterações"})]})]})})]})]})};export{re as default};
//# sourceMappingURL=UserEdit-DroIZSaG.js.map
