import{j as e}from"./query-B88w_-l3.js";import{r as o}from"./vendor-BKU87Gzz.js";import{c as W,a as Q,L as B}from"./router-Cr3qqr-L.js";import{u as F,o as z,m as L,J as K,K as v,k as E,p as A,l as T,j as H,c as C,L as Z,W as X,z as Y,v as $,I as q,e as ee}from"./index-DY2ZM4tI.js";import{F as te}from"./CheckIcon-DeOLvj_K.js";import{u as se}from"./useRealTimeProduction-CQYe6__r.js";import{a as O,F as R}from"./StopIcon-CJc_mX_I.js";import{F as G}from"./ArrowLeftIcon-DeKPabn9.js";import"./utils-CZH8StwO.js";function re({title:s,titleId:l,...n},b){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":l},n),s?o.createElement("title",{id:l},s):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const I=o.forwardRef(re),ae=({machine:s,onSpeedUpdate:l})=>{const{user:n}=F(),[b,x]=o.useState(!1),[t,g]=o.useState((s==null?void 0:s.productionSpeed)||0),[h,p]=o.useState(!1),u=["LEADER","MANAGER","ADMIN"].includes(n==null?void 0:n.role),j=async()=>{if(!t||t<=0){v.error("Velocidade inválida");return}p(!0);try{const r=await fetch(`/api/machines/${s.id}/production-speed`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({productionSpeed:parseInt(t)})});if(!r.ok){const f=await r.json().catch(()=>({}));throw r.status===403?(v.error("Sem permissão"),new Error("INSUFFICIENT_PERMISSION")):(v.error("Erro"),new Error(f.message||"Erro ao atualizar velocidade"))}const y=await r.json();v.success("Salvo"),x(!1),l&&l(y.machine)}catch(r){console.error("Erro ao atualizar velocidade:",r),r.message&&r.message.includes("403")?v.error("Sem permissão"):r.message&&r.message.includes("INSUFFICIENT_PERMISSION")?v.error("Sem permissão"):v.error("Erro")}finally{p(!1)}},m=()=>{g((s==null?void 0:s.productionSpeed)||0),x(!1)};return u?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-5 w-5 text-blue-500 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Velocidade de Produção"})]}),!b&&e.jsx("button",{onClick:()=>x(!0),className:"inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:bg-blue-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Editar"})]}),e.jsx("div",{className:"mt-4",children:b?e.jsxs(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"speed",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Batidas por minuto"}),e.jsx("input",{type:"number",id:"speed",min:"1",max:"1000",value:t,onChange:r=>g(r.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: 120"}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["Velocidade atual: ",(s==null?void 0:s.productionSpeed)||0," batidas/min"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:j,disabled:h||!t||t<=0,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),h?"Salvando...":"Salvar"]}),e.jsxs("button",{onClick:m,disabled:h,className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"Cancelar"]})]})]}):e.jsxs("div",{children:[e.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[(s==null?void 0:s.productionSpeed)||0,e.jsx("span",{className:"text-lg font-normal text-gray-500 ml-2",children:"batidas/min"})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("p",{children:["Produção estimada por hora: ",e.jsx("span",{className:"font-medium",children:(((s==null?void 0:s.productionSpeed)||0)*60).toLocaleString()})," batidas"]}),e.jsxs("p",{children:["Produção estimada por turno (8h): ",e.jsx("span",{className:"font-medium",children:(((s==null?void 0:s.productionSpeed)||0)*60*8).toLocaleString()})," batidas"]})]})]})})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Velocidade de Produção"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[(s==null?void 0:s.productionSpeed)||0," ",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"batidas/min"})]})})]})},ie=({machineId:s,machine:l,refreshTrigger:n=0})=>{const{user:b}=F(),[x,t]=o.useState(!0),[g,h]=o.useState(null),[p,u]=o.useState(null),[j,m]=o.useState(null),r=se(l,1e3),y=async()=>{if(s){t(!0),m(null);try{const i={Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},c=await fetch(`/api/machines/${s}/production/current-shift`,{headers:i});if(!c.ok)throw new Error("Erro ao buscar produção do turno");const S=await c.json();h(S.data);const P=await fetch(`/api/machines/${s}/production/daily`,{headers:i});if(!P.ok)throw new Error("Erro ao buscar produção diária");const M=await P.json();u(M.data)}catch(d){console.error("Erro ao buscar dados de produção:",d),m(d.message),v.error("Erro ao carregar dados de produção")}finally{t(!1)}}};o.useEffect(()=>{y()},[s,n]);const f=d=>{const i=Math.floor(d/60),c=d%60;return`${i}h ${c}m`},w=d=>d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600";return x?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-center h-32",children:[e.jsx(I,{className:"h-8 w-8 text-gray-400 animate-spin"}),e.jsx("span",{className:"ml-2 text-gray-500",children:"Carregando métricas..."})]})}):j?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-center h-32 text-red-500",children:[e.jsx(E,{className:"h-8 w-8"}),e.jsx("span",{className:"ml-2",children:"Erro ao carregar métricas"})]})}):e.jsxs("div",{className:"space-y-6",children:[g&&e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(A,{className:"h-5 w-5 mr-2 text-blue-500"}),"Turno Atual"]}),e.jsx("button",{onClick:y,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Atualizar dados",children:e.jsx(I,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Produção Atual"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.currentProduction}),e.jsx("p",{className:"text-xs text-gray-500",children:"peças produzidas"})]}),e.jsx(T,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Eficiência"}),e.jsxs("p",{className:`text-2xl font-bold ${w(r.efficiency)}`,children:[r.efficiency,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"tempo real"})]}),e.jsx(z,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tempo Funcionando"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:r.runningTimeFormatted||"0h 0m"}),e.jsx("p",{className:"text-xs text-gray-500",children:"turno atual"})]}),e.jsx(A,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Velocidade Atual"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[r.currentSpeed," pç/min"]}),e.jsx("p",{className:`text-xs ${r.isRunning?"text-green-600":"text-red-600"}`,children:r.isRunning?"Funcionando":"Parada"})]}),e.jsx(I,{className:"h-8 w-8 text-orange-500"})]})})]}),g.statusBreakdown&&g.statusBreakdown.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Distribuição do Tempo"}),e.jsx("div",{className:"flex rounded-lg overflow-hidden h-3 bg-gray-200",children:g.statusBreakdown.map((d,i)=>{let c="bg-gray-400";return d.status==="FUNCIONANDO"?c="bg-green-500":d.status==="PARADA"?c="bg-red-500":d.status==="MANUTENCAO"&&(c="bg-yellow-500"),e.jsx("div",{className:`${c}`,style:{width:`${d.percentage}%`},title:`${d.status}: ${f(d.minutes)} (${d.percentage}%)`},i)})}),e.jsx("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:g.statusBreakdown.map((d,i)=>e.jsxs("span",{children:[d.status,": ",d.percentage,"%"]},i))})]})]}),r&&e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(T,{className:"h-5 w-5 mr-2 text-green-500"}),"Produção Diária"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[new Date().toLocaleDateString("pt-BR")," - Dados em Tempo Real"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:Math.floor(r.currentProduction).toLocaleString()}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total de Peças"}),e.jsx("div",{className:"text-xs text-green-600 mt-1",children:r.isRunning?`+${r.currentSpeed}/min`:"Parada"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold ${w(r.efficiency)}`,children:[r.efficiency,"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Eficiência Atual"}),e.jsx("div",{className:`text-xs mt-1 ${w(r.efficiency)}`,children:r.efficiency>=80?"Excelente":r.efficiency>=60?"Boa":"Baixa"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:r.runningTimeFormatted||f(r.runningTime)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Tempo Ativo"}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:r.isRunning?"Em funcionamento":"Parada"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[(l==null?void 0:l.productionSpeed)||0,"/min"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Velocidade Atual"}),e.jsxs("div",{className:"text-xs text-orange-600 mt-1",children:["Configurada: ",(l==null?void 0:l.productionSpeed)||0," peças/min"]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Eficiência em Tempo Real"}),e.jsxs("span",{className:`text-sm font-semibold ${w(r.efficiency)}`,children:[r.efficiency,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${r.efficiency>=80?"bg-green-500":r.efficiency>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(r.efficiency,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{className:"text-gray-700",children:"Meta: 80%"}),e.jsx("span",{children:"100%"})]})]}),e.jsx("div",{className:"mt-4 p-3 rounded-lg bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${r.isRunning?"bg-green-500 animate-pulse":"bg-red-500"}`}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Status: ",r.isRunning?"Funcionando":"Parada"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Última atualização: ",r.lastUpdate?new Date(r.lastUpdate).toLocaleTimeString("pt-BR"):"N/A"]})]})})]})]})},ne=({machine:s,onOperationChange:l})=>{const{user:n}=F(),{hasPermissionForMachine:b}=H(),[x,t]=o.useState(!1),[g,h]=o.useState(""),[p,u]=o.useState(!1),j=b(s.id,"canOperate"),m=s.currentOperation&&(s.currentOperation.status==="ACTIVE"||s.currentOperation.status==="FUNCIONANDO"),r=m&&s.currentOperation.userId===(n==null?void 0:n.id),y=j&&!m&&["STOPPED","PARADA"].includes(s.status),f=m&&(r||["ADMIN","MANAGER"].includes(n==null?void 0:n.role)),w=async()=>{if(y){t(!0);try{const i=await fetch(`/api/machines/${s.id}/start-operation`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({notes:g.trim()||void 0})}),c=await i.json();if(!i.ok)throw new Error(c.message||"Erro ao iniciar operação");l&&l({...s,status:"FUNCIONANDO",currentOperation:c.data,operator:n.name}),h(""),u(!1),console.log("Operação iniciada com sucesso")}catch(i){console.error("Erro ao iniciar operação:",i),alert(i.message||"Erro ao iniciar operação")}finally{t(!1)}}},d=async()=>{if(f){t(!0);try{const i=await fetch(`/api/machines/${s.id}/end-operation`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({notes:g.trim()||void 0})}),c=await i.json();if(!i.ok)throw new Error(c.message||"Erro ao finalizar operação");l&&l({...s,status:"STOPPED",currentOperation:null,operator:"Não atribuído"}),h(""),u(!1),console.log("Operação finalizada com sucesso")}catch(i){console.error("Erro ao finalizar operação:",i),alert(i.message||"Erro ao finalizar operação")}finally{t(!1)}}};return j?e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Controle de Operação"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status atual:"}),e.jsx("span",{className:C("px-2 py-1 rounded-full text-xs font-medium",m?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:m?"Em Operação":"Parada"})]}),m&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Operador:"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(()=>{var c;const i=(c=s.currentOperation.user)==null?void 0:c.name;return!i||i==="div"||typeof i!="string"?"Desconhecido":i})()})]}),p&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Observações (opcional)"}),e.jsx("textarea",{value:g,onChange:i=>h(i.target.value),placeholder:"Digite observações sobre a operação...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-3",children:[y&&e.jsx(e.Fragment,{children:p?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:w,disabled:x,className:"flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-md text-sm font-medium transition-colors",children:[x?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(O,{className:"h-4 w-4 mr-2"}),"Confirmar Início"]}),e.jsx("button",{onClick:()=>{u(!1),h("")},disabled:x,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md text-sm font-medium transition-colors",children:"Cancelar"})]}):e.jsxs("button",{onClick:()=>u(!0),disabled:x,className:"flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-md text-sm font-medium transition-colors",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Iniciar Operação"]})}),f&&e.jsx(e.Fragment,{children:p?e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:d,disabled:x,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-md text-sm font-medium transition-colors",children:[x?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(R,{className:"h-4 w-4 mr-2"}),"Confirmar Finalização"]}),e.jsx("button",{onClick:()=>{u(!1),h("")},disabled:x,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-md text-sm font-medium transition-colors",children:"Cancelar"})]}):e.jsxs("button",{onClick:()=>u(!0),disabled:x,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white rounded-md text-sm font-medium transition-colors",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Finalizar Operação"]})})]}),!y&&!f&&e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:m&&!r?"Máquina em operação por outro usuário":"Máquina não disponível para operação"})]})]}):null},pe=()=>{const{id:s}=W(),l=Q(),{user:n}=F(),{hasPermissionForMachine:b,loading:x}=H(),[t,g]=o.useState(null),[h,p]=o.useState(!0),[u,j]=o.useState(null),[m,r]=o.useState("overview"),[y,f]=o.useState(!1),w=a=>{g(a)};o.useEffect(()=>{s&&n&&!x&&(async()=>{var k;try{if(p(!0),x)return;if(!b(parseInt(s),"canView")){f(!1),j("Você não tem permissão para visualizar esta máquina"),p(!1);return}f(!0);const U=await fetch(`/api/machines/${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!U.ok)throw new Error("Erro ao carregar dados da máquina");const N=await U.json();if(N.success){let V="Não atribuído";if(N.data.operations&&N.data.operations.length>0){const D=N.data.operations[0];D.user&&D.user.name&&(V=String(D.user.name))}const J={...N.data,recentTests:N.data.qualityTests||[],maintenanceHistory:N.data.teflonChanges||[],currentOperation:((k=N.data.operations)==null?void 0:k[0])||null,operator:V,specifications:{maxCapacity:2e3,powerConsumption:"15 kW",operatingTemp:"180-220°C",pressure:"2.5 bar",dimensions:"2.5m x 1.8m x 2.2m",weight:"1500 kg"},production:{current:0,target:2e3,shift:"Turno 1"},efficiency:0,alerts:[]};g(J)}else throw new Error(N.message||"Erro ao carregar dados da máquina")}catch{j("Erro ao carregar dados da máquina")}finally{p(!1)}})()},[s,n,b,x]);const d=a=>({FUNCIONANDO:{label:"Em Operação",color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",icon:O,iconColor:"text-green-600 dark:text-green-400"},RUNNING:{label:"Em Operação",color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",icon:O,iconColor:"text-green-600 dark:text-green-400"},PARADA:{label:"Parada",color:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",icon:R,iconColor:"text-gray-600 dark:text-gray-400"},STOPPED:{label:"Parada",color:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",icon:R,iconColor:"text-gray-600 dark:text-gray-400"},MANUTENCAO:{label:"Manutenção",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",icon:$,iconColor:"text-yellow-600 dark:text-yellow-400"},MAINTENANCE:{label:"Manutenção",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",icon:$,iconColor:"text-yellow-600 dark:text-yellow-400"},ERROR:{label:"Erro",color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",icon:E,iconColor:"text-red-600 dark:text-red-400"},FORA_DE_TURNO:{label:"Fora de Turno",color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",icon:A,iconColor:"text-blue-600 dark:text-blue-400"},OFF_SHIFT:{label:"Fora de Turno",color:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",icon:A,iconColor:"text-blue-600 dark:text-blue-400"}})[a]||{label:"Desconhecido",color:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",icon:A,iconColor:"text-gray-600 dark:text-gray-400"},i=a=>new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(a),c=a=>a>=95?"text-green-600 dark:text-green-400":a>=85?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400";if(h)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(Z,{size:"lg"})});if(u||!t)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:u||"Máquina não encontrada"}),!y&&(u==null?void 0:u.includes("permissão"))&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Entre em contato com o gestor para solicitar acesso a esta máquina."}),e.jsxs(B,{to:"/machines",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Voltar às Máquinas"]})]})});const S=d(t.status),P=S.icon,M=[{id:"overview",label:"Visão Geral",icon:T},{id:"tests",label:"Testes de Qualidade",icon:Y},{id:"maintenance",label:"Manutenção",icon:$},{id:"settings",label:"Configurações",icon:q}];return e.jsxs(e.Fragment,{children:[e.jsxs(X,{children:[e.jsxs("title",{children:[t.name," - Detalhes da Máquina - Sistema ZARA"]}),e.jsx("meta",{name:"description",content:`Detalhes e monitoramento da ${t.name}`})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>l("/machines"),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(G,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.id," • ",t.model," • ",t.location]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:C("inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",S.color),children:[e.jsx(P,{className:C("h-4 w-4 mr-2",S.iconColor)}),S.label]}),t.alerts&&t.alerts.length>0&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",children:[t.alerts.length," alerta",t.alerts.length>1?"s":""]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Eficiência"}),e.jsxs("p",{className:C("text-2xl font-bold",c(t.efficiency)),children:[t.efficiency,"%"]})]}),e.jsx(T,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Produção Atual"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.production?(t.production.current||0).toLocaleString():"0"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Meta: ",t.production.target.toLocaleString()]})]}),e.jsx(O,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Operador"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(()=>{const a=t.operator;return!a||a==="div"||typeof a!="string"?"Não atribuído":a})()}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.production.shift})]}),e.jsx("div",{className:"h-8 w-8 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:(()=>{const a=t.operator;return!a||a==="div"||typeof a!="string"?"NA":a.split(" ").map(k=>k[0]).join("").toUpperCase()})()})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Próxima Manutenção"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[Math.ceil((t.nextMaintenance-new Date)/(1e3*60*60*24))," dias"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:i(t.nextMaintenance).split(" ")[0]})]}),e.jsx(A,{className:"h-8 w-8 text-orange-500"})]})})]}),t.alerts&&t.alerts.length>0&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(E,{className:"h-5 w-5 text-red-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-sm font-medium text-red-800 dark:text-red-400 mb-2",children:["Alertas Ativos (",t.alerts.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.alerts.map(a=>e.jsxs("div",{className:"text-sm text-red-700 dark:text-red-300",children:[e.jsx("span",{className:"font-medium",children:a.message}),e.jsxs("span",{className:"text-red-500 dark:text-red-400 ml-2",children:["• ",i(a.timestamp)]})]},a.id))})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:M.map(a=>{const k=a.icon;return e.jsxs("button",{onClick:()=>r(a.id),className:C("flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors",m===a.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:a.label})]},a.id)})})}),e.jsxs("div",{className:"p-6",children:[m==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Especificações Técnicas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Capacidade Máxima"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[t.specifications.maxCapacity.toLocaleString()," unidades/dia"]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Consumo de Energia"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.specifications.powerConsumption})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Temperatura Operacional"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.specifications.operatingTemp})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Pressão"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.specifications.pressure})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Dimensões"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.specifications.dimensions})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Peso"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.specifications.weight})]})]})]}),e.jsx(ne,{machine:t,onOperationChange:g}),e.jsx(ae,{machine:t,onSpeedUpdate:w}),e.jsx(ie,{machineId:t.id,machine:t,refreshTrigger:t.updatedAt})]}),m==="tests"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Testes de Qualidade Recentes"}),e.jsx(B,{to:"/quality/new-test",className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors",children:"Novo Teste"})]}),e.jsx("div",{className:"space-y-3",children:t.recentTests.map(a=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:["Teste ",a.id]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[i(a.date)," • ",a.operator]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:C("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",a.result==="APPROVED"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:[a.result==="APPROVED"?e.jsx(ee,{className:"h-3 w-3 mr-1"}):e.jsx(E,{className:"h-3 w-3 mr-1"}),a.result==="APPROVED"?"Aprovado":"Reprovado"]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[a.defects," defeito",a.defects!==1?"s":""]})]})]})},a.id))})]}),m==="maintenance"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Histórico de Manutenção"}),e.jsx("div",{className:"space-y-3",children:t.maintenanceHistory.map(a=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.type}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:a.description}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:[i(a.date)," • ",a.technician," • ",a.duration]})]})})},a.id))})]}),m==="settings"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Configurações da Máquina"}),(n==null?void 0:n.role)==="ADMIN"||(n==null?void 0:n.role)==="MANAGER"?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Configurações avançadas em desenvolvimento"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(E,{className:"mx-auto h-12 w-12 text-yellow-400 mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Você não tem permissão para acessar as configurações desta máquina."})]})]})]})]})]})]})};export{pe as default};
//# sourceMappingURL=MachineDetail-BkJQ789y.js.map
