import{j as e}from"./query-B88w_-l3.js";import{r as t}from"./vendor-BKU87Gzz.js";import{u as oe,f as de,r as S,W as ne,m as L,o as B,e as H,k as R,p as k,G as ie,c as E}from"./index-DY2ZM4tI.js";import{a as ce}from"./router-Cr3qqr-L.js";import{F as _}from"./PlusIcon-Bk98C3yE.js";import{F as xe}from"./CalendarIcon-C8U54hvR.js";import"./utils-CZH8StwO.js";function me({title:a,titleId:d,...i},y){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:y,"aria-labelledby":d},i),a?t.createElement("title",{id:d},a):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"}))}const ge=t.forwardRef(me),W=(a,d={})=>{if(!a)return"";const i={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",...d};return new Date(a).toLocaleString("pt-BR",i)},T=(a,d={})=>{if(a==null)return"";const i={minimumFractionDigits:0,maximumFractionDigits:2,...d};return new Intl.NumberFormat("pt-BR",i).format(a)},we=()=>{const{user:a}=oe(),{socket:d,isConnected:i}=de(),y=ce(),[u,I]=t.useState([]),[O,F]=t.useState([]),[z,M]=t.useState(!0),[b,P]=t.useState(null),[h,K]=t.useState(""),[j,Y]=t.useState("ALL"),[v,Z]=t.useState("ALL"),[N,J]=t.useState("ALL"),[G,Q]=t.useState("timestamp"),[$,ee]=t.useState("desc"),[re,q]=t.useState(!1),[ue,he]=t.useState(null),[c,f]=t.useState({machineId:"",teflonType:"",expiryDate:"",observations:""});t.useEffect(()=>{A()},[]),t.useEffect(()=>{if(d)return d.on("teflonChange",U),()=>d.off("teflonChange",U)},[d]);const A=async()=>{try{M(!0);const[r,s]=await Promise.all([S.get("/teflon"),S.get("/machines")]);I(Array.isArray(r.data.data)?r.data.data:[]),F(Array.isArray(s.data.data)?s.data.data:[])}catch(r){console.error("Erro ao carregar dados:",r),P("Erro ao carregar dados do Teflon"),F([]),I([])}finally{M(!1)}},U=r=>{r.type==="TEFLON_CHANGE"&&A()},ae=async r=>{r.preventDefault();try{await S.post("/teflon",c),f({machineId:"",teflonType:"",expiryDate:"",observations:""}),q(!1),A()}catch(s){console.error("Erro ao registrar troca:",s),P("Erro ao registrar troca de Teflon")}},te=r=>{switch(r){case"ACTIVE":return{label:"Ativo",color:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",icon:H,iconColor:"text-green-600 dark:text-green-400"};case"EXPIRING_SOON":return{label:"Expirando",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",icon:R,iconColor:"text-yellow-600 dark:text-yellow-400"};case"EXPIRED":return{label:"Expirado",color:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",icon:k,iconColor:"text-red-600 dark:text-red-400"};default:return{label:"Desconhecido",color:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",icon:k,iconColor:"text-gray-600 dark:text-gray-400"}}},m=r=>{if(!r.expiryDate)return"ACTIVE";const s=new Date,o=new Date(r.expiryDate),l=Math.ceil((o-s)/(1e3*60*60*24));return l<=0?"EXPIRED":l<=7?"EXPIRING_SOON":"ACTIVE"},C=(Array.isArray(u)?u:[]).filter(r=>{var V,X;const s=((V=r.machine)==null?void 0:V.name)||"",o=r.teflonType||"",l=((X=r.user)==null?void 0:X.name)||"",p=r.id.toString().toLowerCase().includes(h.toLowerCase())||s.toLowerCase().includes(h.toLowerCase())||o.toLowerCase().includes(h.toLowerCase())||l.toLowerCase().includes(h.toLowerCase()),g=j==="ALL"||r.machineId===j;let x=!0;v!=="ALL"&&(x=m(r)===v);let n=!0;if(N!=="ALL"){const w=new Date,D=new Date(r.changeDate||r.createdAt);switch(N){case"TODAY":n=D.toDateString()===w.toDateString();break;case"WEEK":const se=new Date(w.getTime()-7*24*60*60*1e3);n=D>=se;break;case"MONTH":const le=new Date(w.getTime()-30*24*60*60*1e3);n=D>=le;break}}return p&&g&&x&&n}).sort((r,s)=>{var p,g,x,n;let o,l;switch(G){case"timestamp":o=new Date(r.changeDate||r.createdAt),l=new Date(s.changeDate||s.createdAt);break;case"machine":o=((p=r.machine)==null?void 0:p.name)||"",l=((g=s.machine)==null?void 0:g.name)||"";break;case"operator":o=((x=r.user)==null?void 0:x.name)||"",l=((n=s.user)==null?void 0:n.name)||"";break;case"status":o=m(r),l=m(s);break;case"type":o=r.teflonType||"",l=s.teflonType||"";break;default:return 0}return $==="asc"?o>l?1:-1:o<l?1:-1});return z?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:e.jsx("title",{children:"Controle de Teflon - Zara Operação"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Controle de Teflon"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Gerencie as trocas de Teflon das máquinas"})]}),((a==null?void 0:a.role)==="OPERATOR"||(a==null?void 0:a.role)==="LEADER"||(a==null?void 0:a.role)==="MANAGER"||(a==null?void 0:a.role)==="ADMIN")&&e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>y("/teflon/change"),className:"mt-4 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800 transition-colors",children:[e.jsx(_,{className:"-ml-1 mr-2 h-5 w-5"}),"Nova Troca"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(B,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total de Trocas"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(u.length)})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:e.jsx(H,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(u.filter(r=>m(r)==="ACTIVE").length)})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/20 rounded-lg",children:e.jsx(R,{className:"h-6 w-6 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Expirando"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(u.filter(r=>m(r)==="EXPIRING_SOON").length)})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-lg",children:e.jsx(k,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Expirados"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(u.filter(r=>m(r)==="EXPIRED").length)})]})]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar trocas...",value:h,onChange:r=>K(r.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:v,onChange:r=>Z(r.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"ALL",children:"Todos os Status"}),e.jsx("option",{value:"ACTIVE",children:"Ativos"}),e.jsx("option",{value:"EXPIRING_SOON",children:"Expirando"}),e.jsx("option",{value:"EXPIRED",children:"Expirados"})]}),e.jsxs("select",{value:j,onChange:r=>Y(r.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"ALL",children:"Todas as Máquinas"}),O.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsxs("select",{value:N,onChange:r=>J(r.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"TODAY",children:"Hoje"}),e.jsx("option",{value:"WEEK",children:"Esta Semana"}),e.jsx("option",{value:"MONTH",children:"Este Mês"}),e.jsx("option",{value:"ALL",children:"Todos os Períodos"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[C.length," trocas"]}),e.jsxs("div",{className:E("flex items-center space-x-2 px-3 py-1 rounded-full text-xs font-medium",i?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:[e.jsx("div",{className:E("h-1.5 w-1.5 rounded-full",i?"bg-green-500":"bg-red-500")}),e.jsx("span",{children:i?"Online":"Offline"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ordenar por:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:G,onChange:r=>Q(r.target.value),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"timestamp",children:"Data"}),e.jsx("option",{value:"machine",children:"Máquina"}),e.jsx("option",{value:"operator",children:"Operador"}),e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"type",children:"Tipo de Teflon"})]}),e.jsx("button",{onClick:()=>ee($==="asc"?"desc":"asc"),className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx(ge,{className:"h-4 w-4"})})]})]})]})}),b&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:b})}),C.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700 px-6 py-12 text-center",children:[e.jsx(B,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nenhuma troca encontrada"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:h||v!=="ALL"||j!=="ALL"||N!=="ALL"?"Tente ajustar os filtros para ver mais resultados.":"Comece registrando uma nova troca de Teflon."}),((a==null?void 0:a.role)==="OPERATOR"||(a==null?void 0:a.role)==="LEADER"||(a==null?void 0:a.role)==="MANAGER"||(a==null?void 0:a.role)==="ADMIN")&&e.jsx("div",{className:"mt-6",children:e.jsxs(L.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>y("/teflon/change"),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-800 transition-colors",children:[e.jsx(_,{className:"-ml-1 mr-2 h-5 w-5"}),"Nova Troca"]})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 gap-6",children:C.map((r,s)=>{var g,x,n;const o=m(r),l=te(o),p=l.icon;return e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.05},className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>{((a==null?void 0:a.role)==="LEADER"||(a==null?void 0:a.role)==="MANAGER"||(a==null?void 0:a.role)==="ADMIN")&&y(`/teflon/${r.id}`)},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:E("flex items-center space-x-2 px-3 py-1 rounded-full text-xs font-medium",l.color),children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx("span",{children:l.label})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:((g=r.machine)==null?void 0:g.name)||"Máquina não encontrada"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:["Tipo: ",r.teflonType||"Não especificado"]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center text-sm text-gray-500 dark:text-gray-400 space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Troca: ",W(r.changeDate||r.createdAt)]})]}),r.expiryDate&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{children:["Expira: ",W(r.expiryDate)]})]}),((x=r.user)==null?void 0:x.name)&&e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("span",{children:["Por: ",r.user.name]})}),((n=r.status)==null?void 0:n.daysUntilExpiry)!==void 0&&e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:E("font-medium",r.status.daysUntilExpiry<=0?"text-red-600 dark:text-red-400":r.status.daysUntilExpiry<=7?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400"),children:r.status.daysUntilExpiry<=0?`Expirado há ${Math.abs(r.status.daysUntilExpiry)} dias`:`${r.status.daysUntilExpiry} dias restantes`})})]}),r.observations&&e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 italic",children:['"',r.observations,'"']})})]}),((a==null?void 0:a.role)==="LEADER"||(a==null?void 0:a.role)==="MANAGER"||(a==null?void 0:a.role)==="ADMIN")&&e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("div",{className:"text-gray-400 dark:text-gray-500",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})})]})},r.id)})}),re&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Registrar Nova Troca de Teflon"}),e.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Máquina"}),e.jsxs("select",{value:c.machineId,onChange:r=>f({...c,machineId:r.target.value}),required:!0,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione uma máquina"}),O.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Teflon"}),e.jsxs("select",{value:c.teflonType,onChange:r=>f({...c,teflonType:r.target.value}),required:!0,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione o tipo"}),e.jsx("option",{value:"PTFE Standard",children:"PTFE Standard"}),e.jsx("option",{value:"PTFE Reforçado",children:"PTFE Reforçado"}),e.jsx("option",{value:"PTFE Alta Temperatura",children:"PTFE Alta Temperatura"}),e.jsx("option",{value:"PTFE Antiaderente",children:"PTFE Antiaderente"}),e.jsx("option",{value:"Outros",children:"Outros"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Validade"}),e.jsx("input",{type:"datetime-local",value:c.expiryDate,onChange:r=>f({...c,expiryDate:r.target.value}),required:!0,min:new Date().toISOString().slice(0,16),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{value:c.observations,onChange:r=>f({...c,observations:r.target.value}),rows:3,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Observações adicionais (opcional)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{q(!1),f({machineId:"",teflonType:"",expiryDate:"",observations:""})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:"Registrar Troca"})]})]})]})})}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(R,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:b})})]})})]})]})};export{we as default};
//# sourceMappingURL=Teflon-Wu6aWc68.js.map
