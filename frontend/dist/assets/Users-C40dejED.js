import{j as e}from"./query-B88w_-l3.js";import{r as i}from"./vendor-BKU87Gzz.js";import{u as B,W as V,G as q,D as Q,Q as R,m as W,c as u,e as E,O as M,b as Z,r as S}from"./index-DY2ZM4tI.js";import{a as H}from"./router-Cr3qqr-L.js";import{F as J}from"./PlusIcon-Bk98C3yE.js";import{F as K}from"./PencilIcon-c7Nm3ZXQ.js";import"./utils-CZH8StwO.js";const ie=()=>{const{user:h}=B(),p=H(),[y,k]=i.useState([]),[C,f]=i.useState(!0),[j,g]=i.useState(null),[o,v]=i.useState(""),[c,N]=i.useState(""),[x,w]=i.useState(""),[l,n]=i.useState(1),[d,F]=i.useState(1),[b,O]=i.useState(0),T=[{value:"",label:"Todos os Roles"},{value:"OPERATOR",label:"Operador"},{value:"LEADER",label:"Líder"},{value:"MANAGER",label:"Gestor"},{value:"ADMIN",label:"Administrador"}],U=[{value:"",label:"Todos os Status"},{value:"true",label:"Ativo"},{value:"false",label:"Inativo"}],$=s=>({OPERATOR:"Operador",LEADER:"Líder",MANAGER:"Gestor",ADMIN:"Administrador"})[s]||s,P=s=>({OPERATOR:"bg-blue-100 text-blue-800",LEADER:"bg-green-100 text-green-800",MANAGER:"bg-purple-100 text-purple-800",ADMIN:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",A=async()=>{var s,a;try{f(!0),g(null);const t=new URLSearchParams({page:l.toString(),limit:"10"});o&&t.append("search",o),c&&t.append("role",c),x&&t.append("active",x);const r=await S.get(`/users?${t.toString()}`);r.data.success&&(k(r.data.data),F(r.data.pagination.totalPages),O(r.data.pagination.total))}catch(t){console.error("Erro ao carregar usuários:",t),g(((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Erro ao carregar usuários")}finally{f(!1)}};i.useEffect(()=>{A()},[l,o,c,x]);const L=s=>{v(s.target.value),n(1)},G=s=>{N(s.target.value),n(1)},I=s=>{w(s.target.value),n(1)},_=async(s,a)=>{var t,r;try{const m=a?`/users/${s}/deactivate`:`/users/${s}/activate`;await S.patch(m),A()}catch(m){console.error("Erro ao alterar status:",m),g(((r=(t=m.response)==null?void 0:t.data)==null?void 0:r.message)||"Erro ao alterar status do usuário")}},z=s=>new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return["MANAGER","ADMIN"].includes(h==null?void 0:h.role)?e.jsxs(e.Fragment,{children:[e.jsx(V,{children:e.jsx("title",{children:"Usuários - Zara Operação"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Usuários"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Gerencie usuários do sistema (",b," usuários)"]})]}),e.jsxs("button",{onClick:()=>p("/users/new"),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(J,{className:"h-5 w-5 mr-2"}),"Novo Usuário"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por nome ou email...",value:o,onChange:L,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsx("select",{value:c,onChange:G,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:T.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("select",{value:x,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:U.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsxs("button",{onClick:()=>{v(""),N(""),w(""),n(1)},className:"flex items-center justify-center px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Limpar"]})]})}),j&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-700",children:j})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:C?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):y.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum usuário encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Crachá"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Última Atualização"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Atividades"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(s=>{var a,t,r;return e.jsxs(W.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx(R,{className:"h-6 w-6 text-gray-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.badgeNumber||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:u("inline-flex px-2 py-1 text-xs font-semibold rounded-full",P(s.role)),children:$(s.role)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[s.isActive?e.jsx(E,{className:"h-5 w-5 text-green-500 mr-2"}):e.jsx(M,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("span",{className:u("text-sm",s.isActive?"text-green-700":"text-red-700"),children:s.isActive?"Ativo":"Inativo"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.updatedAt?z(s.updatedAt):"Nunca"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["Operações: ",((a=s._count)==null?void 0:a.machineOperations)||0]}),e.jsxs("div",{children:["Testes: ",((t=s._count)==null?void 0:t.qualityTests)||0]}),e.jsxs("div",{children:["Teflon: ",((r=s._count)==null?void 0:r.teflonChanges)||0]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>p(`/users/${s.id}`),className:"text-blue-600 hover:text-blue-900 p-1",title:"Ver detalhes",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>p(`/users/${s.id}/edit`),className:"text-indigo-600 hover:text-indigo-900 p-1",title:"Editar",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(s.id,s.isActive),className:u("p-1",s.isActive?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"),title:s.isActive?"Desativar":"Ativar",children:s.isActive?e.jsx(M,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})})]})})]},s.id)})})]})})}),d>1&&e.jsxs("div",{className:"flex items-center justify-between bg-white px-4 py-3 border-t border-gray-200 sm:px-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>n(s=>Math.max(s-1,1)),disabled:l===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsx("button",{onClick:()=>n(s=>Math.min(s+1,d)),disabled:l===d,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Próximo"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando"," ",e.jsx("span",{className:"font-medium",children:(l-1)*10+1})," ","até"," ",e.jsx("span",{className:"font-medium",children:Math.min(l*10,b)})," ","de"," ",e.jsx("span",{className:"font-medium",children:b})," ","resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>n(s=>Math.max(s-1,1)),disabled:l===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),Array.from({length:d},(s,a)=>a+1).map(s=>e.jsx("button",{onClick:()=>n(s),className:u("relative inline-flex items-center px-4 py-2 border text-sm font-medium",s===l?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:s},s)),e.jsx("button",{onClick:()=>n(s=>Math.min(s+1,d)),disabled:l===d,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Próximo"})]})})]})]})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600",children:"Você não tem permissão para acessar esta página."})]})})};export{ie as default};
//# sourceMappingURL=Users-C40dejED.js.map
