import{j as e}from"./query-B88w_-l3.js";import{r as l}from"./vendor-BKU87Gzz.js";import{L as f}from"./router-Cr3qqr-L.js";import{u as X,f as ee,g as te,h as re,W as se,c as x,k as ae,l as de,n as U,x as $,p as ne,R as p,b as ie,q as le,y as ce,z as oe,v as xe,A as ue,r as ge,m as me,s as he,t as be,w as fe}from"./index-DY2ZM4tI.js";import"./utils-CZH8StwO.js";const Re=()=>{var S,T,M,O,F,P,C;const[k,q]=l.useState("today"),[_,L]=l.useState("current"),{user:v}=X(),{isConnected:w}=ee(),{machines:m}=te(),{notifications:pe}=re(),c=(()=>{if(!m||m.length===0)return{teamProduction:0,teamEfficiency:0,activeMachines:0,qualityRate:95,downtimeMinutes:0};let t=0,n=0,r=0,s=0,h=0;return m.forEach(i=>{const a=i.status==="FUNCIONANDO"||i.status==="RUNNING",y=i.status==="FORA_DE_TURNO"||i.status==="OFF_SHIFT";if(a&&i.productionSpeed){const o=i.productionSpeed,b=480,u=85,g=Math.floor(b*o*(u/100));t+=g,n+=u,r++,h++}else y||(s+=45)}),{teamProduction:t,teamEfficiency:h>0?Math.round(n/h):0,activeMachines:r,qualityRate:95,downtimeMinutes:s}})(),[R,E]=l.useState(!0),[N,A]=l.useState(null),[d,H]=l.useState(null),[G,Q]=l.useState([]),[V,W]=l.useState([]),[Z,z]=l.useState([]),B=async()=>{var t,n;try{E(!0),A(null);const r=await ge.get(`/reports/leader-dashboard?timeRange=${k}`);if(r.data.success)H(r.data.data),Q(r.data.data.teamMembers||[]),W(r.data.data.supervisedMachines||[]),z(r.data.data.recentAlerts||[]);else throw new Error(r.data.message||"Erro ao carregar dados")}catch(r){console.error("Erro ao buscar dados do líder:",r),A(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||r.message||"Erro ao carregar dados do dashboard")}finally{E(!1)}};l.useEffect(()=>{B()},[k]);const j=({title:t,value:n,target:r,change:s,trend:h,icon:i,format:a="number",unit:y=""})=>{const o=r?n/r*100:0,b=h==="up",u=g=>a==="percentage"?`${g}%`:a==="time"?`${g}min`:`${fe(g)}${y}`;return e.jsxs(me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(i,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u(n)})]})]}),s!==void 0&&e.jsxs("div",{className:x("flex items-center space-x-1 text-sm font-medium",b?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[b?e.jsx(he,{className:"h-4 w-4"}):e.jsx(be,{className:"h-4 w-4"}),e.jsxs("span",{children:[Math.abs(s),"%"]})]})]}),r&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["Meta: ",u(r)]}),e.jsxs("span",{children:[Math.round(o),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:x("h-2 rounded-full transition-all duration-300",o>=100?"bg-green-500":o>=80?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.min(o,100)}%`}})})]})]})},Y=({machine:t})=>{const n=a=>{switch(a){case"FUNCIONANDO":case"RUNNING":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"PARADA":case"STOPPED":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";case"MANUTENCAO":case"MAINTENANCE":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"ERROR":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400";case"FORA_DE_TURNO":case"OFF_SHIFT":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}},r=a=>{switch(a){case"FUNCIONANDO":case"RUNNING":return"Funcionando";case"PARADA":case"STOPPED":return"Parada";case"MANUTENCAO":case"MAINTENANCE":return"Manutenção";case"ERROR":return"Erro";case"FORA_DE_TURNO":case"OFF_SHIFT":return"Fora de Turno";default:return"Desconhecido"}},s=m==null?void 0:m.find(a=>a.id===t.id||a.name===t.name),i=(()=>{if(!s)return t.efficiency||0;const a=s.status,y=a==="FUNCIONANDO"||a==="RUNNING",o=a==="PARADA"||a==="STOPPED",b=a==="FORA_DE_TURNO"||a==="OFF_SHIFT",u=a==="MANUTENCAO"||a==="MAINTENANCE";if(b)return 0;if(y){if(!s.productionSpeed)return acc;const g=s.productionSpeed,I=s.runningTime||0,J=s.currentProduction||0;if(I>0){const K=I*g,D=Math.min(Math.round(J/K*100),100);return D>0?D:85}return 85}else{if(o)return Math.max(t.efficiency-20,10);if(u)return 0}return t.efficiency||0})();return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("span",{className:x("px-2 py-1 text-xs font-medium rounded-full",n((s==null?void 0:s.status)||t.status)),children:r((s==null?void 0:s.status)||t.status)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Eficiência:"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[i,"%"]})]}),t.operator&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Operador:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.operator})]})]})]})};return e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx("title",{children:"Dashboard do Líder - Sistema ZARA"}),e.jsx("meta",{name:"description",content:"Dashboard de liderança do Sistema ZARA"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard do Líder"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["Bem-vindo, ",v==null?void 0:v.name,"! Monitore sua equipe e operações."]})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-3",children:[e.jsxs("select",{value:_,onChange:t=>L(t.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"current",children:"Turno Atual"}),e.jsx("option",{value:"morning",children:"Turno Manhã"}),e.jsx("option",{value:"afternoon",children:"Turno Tarde"}),e.jsx("option",{value:"night",children:"Turno Noite"})]}),e.jsxs("select",{value:k,onChange:t=>q(t.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"today",children:"Hoje"}),e.jsx("option",{value:"week",children:"Esta Semana"}),e.jsx("option",{value:"month",children:"Este Mês"})]}),e.jsxs("div",{className:x("flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium",w?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"),children:[e.jsx("div",{className:x("h-2 w-2 rounded-full",w?"bg-green-500":"bg-red-500")}),e.jsx("span",{children:w?"Online":"Offline"})]})]})]}),R&&e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"Carregando dados..."})]}),N&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 text-red-400 mr-2"}),e.jsxs("p",{className:"text-red-800 dark:text-red-400",children:["Erro ao carregar dados: ",N]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(j,{title:"Produção da Equipe",value:c.teamProduction,target:((T=(S=d==null?void 0:d.shiftMetrics)==null?void 0:S.production)==null?void 0:T.target)||8e3,change:8.5,trend:c.teamProduction>6e3?"up":"down",icon:de,unit:" pcs"}),e.jsx(j,{title:"Taxa de Qualidade",value:c.qualityRate,target:((O=(M=d==null?void 0:d.shiftMetrics)==null?void 0:M.quality)==null?void 0:O.target)||98,change:-1.2,trend:c.qualityRate>=95?"up":"down",icon:U,format:"percentage"}),e.jsx(j,{title:"Eficiência da Equipe",value:c.teamEfficiency,target:((F=d==null?void 0:d.teamPerformance)==null?void 0:F.target)||90,change:2.1,trend:c.teamEfficiency>=80?"up":"down",icon:$,format:"percentage"}),e.jsx(j,{title:"Tempo de Parada",value:c.downtimeMinutes,target:((C=(P=d==null?void 0:d.shiftMetrics)==null?void 0:P.downtime)==null?void 0:C.target)||30,change:15,trend:c.downtimeMinutes<60?"up":"down",icon:ne,format:"time"})]}),!R&&!N&&d&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Máquinas Supervisionadas"}),e.jsxs(f,{to:p.MACHINES,className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 flex items-center space-x-1",children:[e.jsx("span",{children:"Ver todas"}),e.jsx(ie,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:V.map(t=>e.jsx(Y,{machine:t},t.id))})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Alertas Recentes"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400 text-xs font-medium px-2 py-1 rounded-full",children:[d.alerts.critical," críticos"]})})]}),e.jsx("div",{className:"space-y-4",children:Z.map(t=>{const n=r=>{switch(r){case"high":return"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20";case"medium":return"border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-900/20";case"low":return"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20";default:return"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800"}};return e.jsx("div",{className:x("p-4 rounded-lg border",n(t.severity)),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.message}),e.jsxs("div",{className:"mt-1 flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:t.machine}),e.jsx("span",{children:"•"}),e.jsx("span",{children:le(t.timestamp)})]})]}),e.jsx("span",{className:x("ml-2 px-2 py-1 text-xs font-medium rounded-full",t.status==="active"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":t.status==="acknowledged"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400"),children:t.status==="active"?"Ativo":t.status==="acknowledged"?"Reconhecido":"Resolvido"})]})},t.id)})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs(f,{to:p.NOTIFICATIONS,className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 flex items-center space-x-1",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{children:"Ver todas as notificações"})]})})]})})]}),!R&&!N&&d&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Status da Equipe"}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[d.teamPerformance.activeOperators,"/",d.teamPerformance.totalOperators," ativos"]})]}),e.jsx("div",{className:"space-y-4",children:G.map(t=>{const n=s=>{switch(s){case"active":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400";case"break":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400";case"offline":return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400"}},r=s=>{switch(s){case"active":return"Ativo";case"break":return"Pausa";case"offline":return"Offline";default:return"Desconhecido"}};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:t.name.split(" ").map(s=>s[0]).join("")})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.machine," • Eficiência: ",t.efficiency,"%"]})]})]}),e.jsx("span",{className:x("px-2 py-1 text-xs font-medium rounded-full",n(t.status)),children:r(t.status)})]},t.id)})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Ações Rápidas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(f,{to:p.QUALITY_NEW,className:"flex items-center space-x-3 p-3 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{children:"Novo Teste de Qualidade"})]}),e.jsxs(f,{to:p.REPORTS,className:"flex items-center space-x-3 p-3 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(oe,{className:"h-5 w-5"}),e.jsx("span",{children:"Relatórios de Turno"})]}),e.jsxs(f,{to:p.MACHINES,className:"flex items-center space-x-3 p-3 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(xe,{className:"h-5 w-5"}),e.jsx("span",{children:"Gerenciar Máquinas"})]}),e.jsxs(f,{to:p.USERS,className:"flex items-center space-x-3 p-3 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx($,{className:"h-5 w-5"}),e.jsx("span",{children:"Gerenciar Equipe"})]}),e.jsxs("button",{className:"flex items-center space-x-3 p-3 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors w-full text-left",children:[e.jsx(ue,{className:"h-5 w-5"}),e.jsx("span",{children:"Agendar Manutenção"})]})]})]})]})]})]})};export{Re as default};
//# sourceMappingURL=LeaderDashboard-C3W3iAbm.js.map
